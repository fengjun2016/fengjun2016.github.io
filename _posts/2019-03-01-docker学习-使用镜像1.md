---
layout:     post
title:      Docker学习-使用镜像1
subtitle:   获取镜像
date:       2019-03-01
author:     fengfeng
header-img: img/post-bg-universe.jpg
catalog: true
tags:
    - Docker
---

## 前言

之前提到过, `Docker Hub`上有大量的高质量的镜像可以使用，这里我们就说一下怎么获取这些镜像。
从Docker镜像仓库获取镜像的命令是 `docker pull`。 其命令格式为如下:
![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gi4bhv2e37j310e0bcq4q.jpg)

具体的选项可以通过`docker pull --help`命令看到，这里我们说一下镜像名称的格式。
* Docker镜像仓库地址: 地址的格式一般是`<域名/IP>[:端口号]`。默认地址是`Docker Hub`。
* 仓库名: 如之前所说, 这里的仓库名是两段式名称，即`<用户名>/<软件名>`。对于`Docker Hub`,如果不给出用户名，则默认是`library`, 也即是官方提供的镜像。

比如:
![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gi4glpjvcmj315m0kcq7s.jpg)

上面的命令中没有给出Docker镜像的仓库地址，因此将会从`Docker Hub`获取镜像。而镜像名称是ubuntu:18.04,因此将会获取官方镜像library/ubunutu仓库中标签为18.04的镜像。

从下载过程中我们可以看到我们之前提及的分层存储的概念，镜像是由多层存储所构成。下载也是一层一层的去下载, 并非单一文件。下载过程中给出了每一层的ID的前12位。并且下载结束后，给出该镜像完整的sha256的摘要，以确保下载一致性。

在使用上面命令的时候，你可能会发现，你所看到的层ID以及sha256的摘要和这里的不一样。这是因为官方镜像是一直在维护的，有任何新的bug, 或者版本更新，都会进行修复再以原来的标签发布，这样可以确保任何使用这个标签的用户可以获得更安全，更稳定的镜像。

## 运行

有了镜像后，我们就能够以这个镜像为基础启动并运行一个容器。以上面的ubuntu:18.04为例,如果我们打算启动里面的bash并且进行交互式操作的话，可以执行下面的命令。
![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gi5izbf5plj31b80rcdmf.jpg)

`docker run`就是运行容器的命令
* `-it`: 这是两个参数，一个是`-i`: 交互式操作，一个是`-t`终端。我们这里打算进入`bash`执行一些命令并查询返回结果，因此我们需要交互式终端。
* `--rm`: 这个参数就是说容器退出后随之将其删除。默认情况下，为了排障需求，退出的容器并不会立即删除，除非手动`docker rm`。我们这里只是随便执行了命令，看看结果，不需要排障和保留结果，因此使用`--rm`可以避免浪费空间。
* `ubuntu:18.04`: 这里指用`ubuntu:18.04`镜像为基础来启动容器。
* ·`bash`: 放在镜像名后的是 `命令`, 这里我们希望有个交互式`shell`，因此用的是`bash`。

进入容器后，我们可以在 `Shell` 下操作，执行任何所需的命令。这里，我们执行了 `cat /etc/os-release`，这是 `Linux` 常用的查看当前系统版本的命令，从返回的结果可以看到容器内是 Ubuntu 18.04.1 LTS 系统。
最后我们通过`exit` 退出了这个容器。