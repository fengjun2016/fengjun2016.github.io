---
layout:     post
title:      Webç«¯å³æ—¶é€šè®¯æŠ€æœ¯åŸç†1
subtitle:   åŸç†å’Œè¿‡ç¨‹åˆ†æ
date:       2020-02-01
author:     fengfeng
header-img: img/post-bg-re-vs-ng2.jpg
catalog: true
tags:
    - IM
    - å³æ—¶é€šè®¯
    - Webå¼€å‘
---

## å‰è¨€

æœ‰å…³`IM(InstantMessage)`èŠå¤©åº”ç”¨(å¦‚: å¾®ä¿¡, QQ),æ¶ˆæ¯æ¨é€æŠ€æœ¯(å¦‚ï¼šç°ä»Šç§»åŠ¨ç«¯Appæ ‡é…çš„æ¶ˆæ¯æ¨é€æ¨¡å—)ç­‰å³æ—¶é€šè®¯åº”ç”¨åœºæ™¯ä¸‹ï¼Œå¤§å¤šæ•°éƒ½æ˜¯æ¡Œé¢åº”ç”¨ç¨‹åºæˆ–è€…nativeåº”ç”¨è¾ƒä¸ºæµè¡Œã€‚

è€ŒWebç«¯çš„IMåº”ç”¨ï¼Œç”±äºæµè§ˆå™¨çš„å…¼å®¹æ€§ä»¥åŠå…¶å›ºæœ‰çš„"å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨å¤„ç†å¹¶å“åº”"çš„é€šä¿¡æ¨¡å‹ï¼Œé€ æˆäº†è¦åœ¨æµè§ˆå™¨ä¸­å®ç°ä¸€ä¸ªå…¼å®¹æ€§è¾ƒå¥½çš„IMåº”ç”¨, å…¶é€šä¿¡è¿‡ç¨‹å¿…ç„¶æ˜¯è¯¸å¤šæŠ€æœ¯çš„ç»„åˆï¼Œæœ¬æ–‡çš„ç›®çš„å°±æ˜¯è¦è¯¦ç»†æ¢è®¨è¿™äº›æŠ€æœ¯å¹¶åˆ†æå…¶åŸç†å’Œè¿‡ç¨‹ã€‚

## ä¸€Â·ä¼ ç»ŸWebçš„é€šä¿¡åŸç†
æµè§ˆå™¨æœ¬èº«ä½œä¸ºä¸€ä¸ªç˜¦å®¢æˆ·ç«¯ï¼Œä¸å…·å¤‡ç›´æ¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥è¾¾åˆ°å’Œå¤„äºå¼‚åœ°çš„å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯æµè§ˆå™¨é€šä¿¡çš„åŠŸèƒ½ã€‚è¿™å’Œæˆ‘ä»¬æ¡Œé¢åº”ç”¨çš„å·¥ä½œæ–¹å¼æ˜¯ä¸åŒçš„ï¼Œé€šå¸¸æ¡Œé¢åº”ç”¨é€šè¿‡socketå¯ä»¥å’Œè¿œç¨‹ä¸»æœºä¸Šå¦å¤–ä¸€ç«¯çš„ä¸€ä¸ªè¿›ç¨‹å»ºç«‹TCPè¿æ¥ï¼Œä»è€Œè¾¾åˆ°å…¨åŒå·¥çš„å³æ—¶é€šä¿¡ã€‚            

æµè§ˆå™¨ä»è¯ç”Ÿå¼€å§‹ä¸€ç›´èµ°çš„æ˜¯å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è¿”å›çš„æ¨¡å¼ï¼Œå³ä½¿å‘å±•è‡³ä»Šä»ç„¶æ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚æ‰€ä»¥è‚¯å®šçš„æ˜¯ï¼Œè¦æƒ³å®ç°ä¸¤ä¸ªå®¢æˆ·ç«¯çš„é€šä¿¡ï¼Œå¿…ç„¶è¦é€šè¿‡æœåŠ¡å™¨è¿›è¡Œä¿¡æ¯çš„è½¬å‘ã€‚ä¾‹å¦‚Aè¦å’ŒBé€šä¿¡ï¼Œåˆ™åº”è¯¥æ˜¯Aå…ˆæŠŠä¿¡æ¯å‘é€ç»™IMåº”ç”¨æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ ¹æ®Aä¿¡æ¯ä¸­æºå¸¦çš„æ¥æ”¶è€…å°†å®ƒå†è½¬å‘ç»™B,åŒæ ·Båˆ°Aä¹Ÿæ˜¯è¿™ç§æ¨¡å¼ï¼Œå¦‚ä¸‹æ˜¯æ‰€ç¤º:

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1giex6zrgc6j30h90eijsv.jpg)

## äºŒ. ä¼ ç»Ÿé€šä¿¡æ–¹å¼å®ç°IMåº”ç”¨éœ€è¦è§£å†³çš„é—®é¢˜
æˆ‘ä»¬è®¤è¯†åˆ°åŸºäºwebå®ç°IMè½¯ä»¶ä¾ç„¶è¦èµ°æµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨çš„æ¨¡å¼ï¼Œè¿™ç§æ–¹å¼ä¸‹ï¼Œé’ˆå¯¹IMè½¯ä»¶çš„å¼€å‘éœ€è¦è§£å†³å¦‚ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š
* 1.å…¨åŒå·¥é€šä¿¡
  > å³è¾¾åˆ°æµè§ˆå™¨æ‹‰å–(pull)æœåŠ¡å™¨æ•°æ®,æœåŠ¡å™¨æ¨é€(push)æ•°æ®åˆ°æµè§ˆå™¨;
* 2.ä½å»¶è¿Ÿ
  > å³æµè§ˆå™¨Aå‘é€ç»™Bçš„ä¿¡æ¯ç»è¿‡æœåŠ¡å™¨è¦å¿«é€Ÿè½¬å‘ç»™B, åŒç†Bçš„ä¿¡æ¯ä¹Ÿè¦å¿«é€Ÿäº¤ç»™A, å®é™…ä¸Šå°±æ˜¯è¦æ±‚ä»»ä½•æµè§ˆå™¨èƒ½å¤Ÿè¯·æ±‚æœåŠ¡å™¨çš„æ•°æ®ï¼ŒæœåŠ¡å™¨èƒ½å¤Ÿå¿«é€Ÿæ¨é€æ•°æ®åˆ°æµè§ˆå™¨;
* 3.æ”¯æŒè·¨åŸŸ
  > é€šå¸¸å®¢æˆ·ç«¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½æ˜¯å¤„äºç½‘ç»œçš„ä¸åŒä½ç½®ï¼Œæµè§ˆå™¨æœ¬èº«ä¸å…è®¸é€šè¿‡è„šæœ¬ç›´æ¥è®¿é—®ä¸åŒåŸŸåä¸‹çš„æœåŠ¡å™¨ï¼Œå³ä½¿IPåœ°å€ç›¸åŒåŸŸåä¸åŒä¹Ÿä¸è¡Œï¼ŒåŸŸåç›¸åŒç«¯å£ä¸åŒä¹Ÿä¸è¡Œï¼Œè¿™æ–¹é¢ä¸»è¦æ˜¯ä¸ºäº†å®‰å…¨è€ƒè™‘ã€‚
  

æ³¨: å…³äºæµè§ˆå™¨è·¨åŸŸè®¿é—®çš„å®‰å…¨é—®é¢˜ï¼Œæœ‰ä¸€ä¸ªè¢«ç§°ä¸ºCSRFç½‘ç»œæ”»å‡»æ–¹å¼, è¯·çœ‹ä¸‹é¢çš„æ‘˜å½•
> CSRFï¼ˆCross-site request forgeryï¼‰ï¼Œä¸­æ–‡åç§°ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œä¹Ÿè¢«ç§°ä¸ºï¼šone click attack/session ridingï¼Œç¼©å†™ä¸ºï¼šCSRF/XSRFã€‚

> ä½ è¿™å¯ä»¥è¿™ä¹ˆç†è§£CSRFæ”»å‡»ï¼šæ”»å‡»è€…ç›—ç”¨äº†ä½ çš„èº«ä»½ï¼Œä»¥ä½ çš„åä¹‰å‘é€æ¶æ„è¯·æ±‚ã€‚CSRFèƒ½å¤Ÿåšçš„äº‹æƒ…åŒ…æ‹¬ï¼šä»¥ä½ åä¹‰å‘é€é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼Œç›—å–ä½ çš„è´¦å·ï¼Œç”šè‡³äºè´­ä¹°å•†å“ï¼Œè™šæ‹Ÿè´§å¸è½¬è´¦......é€ æˆçš„é—®é¢˜åŒ…æ‹¬ï¼šä¸ªäººéšç§æ³„éœ²ä»¥åŠè´¢äº§å®‰å…¨ã€‚

> CSRFè¿™ç§æ”»å‡»æ–¹å¼åœ¨2000å¹´å·²ç»è¢«å›½å¤–çš„å®‰å…¨äººå‘˜æå‡ºï¼Œä½†åœ¨å›½å†…ï¼Œç›´åˆ°06å¹´æ‰å¼€å§‹è¢«å…³æ³¨ï¼Œ08å¹´ï¼Œå›½å†…å¤–çš„å¤šä¸ªå¤§å‹ç¤¾åŒºå’Œäº¤äº’ç½‘ç«™åˆ†åˆ«çˆ†å‡ºCSRFæ¼æ´ï¼Œå¦‚ï¼šNYTimes.comï¼ˆçº½çº¦æ—¶æŠ¥ï¼‰ã€Metafilterï¼ˆä¸€ä¸ªå¤§å‹çš„BLOGç½‘ç«™ï¼‰ï¼ŒYouTubeå’Œç™¾åº¦HI......è€Œç°åœ¨ï¼Œäº’è”ç½‘ä¸Šçš„è®¸å¤šç«™ç‚¹ä»å¯¹æ­¤æ¯«æ— é˜²å¤‡ï¼Œä»¥è‡³äºå®‰å…¨ä¸šç•Œç§°CSRFä¸ºâ€œæ²‰ç¡çš„å·¨äººâ€ã€‚

## ä¸‰.å…¨åŒå·¥ä½å»¶è¿Ÿçš„è§£å†³åŠæ³•
### è§£å†³æ–¹æ¡ˆ3.1: å®¢æˆ·ç«¯æµè§ˆå™¨è½®è¯¢æœåŠ¡å™¨(polling)

>è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå…¶åŸç†æ˜¯å®¢æˆ·ç«¯é€šè¿‡Ajaxçš„æ–¹å¼æ¯éš”ä¸€ä¸ªå°æ®µæ—¶é—´å°±å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯,å®¢æˆ·ç«¯æ ¹æ®è·å¾—æ•°æ®æ¥æ›´æ–°ç•Œé¢ï¼Œè¿™æ ·å°±é—´æ¥å®ç°äº†å³æ—¶é€šä¿¡ã€‚ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œç¼ºç‚¹æ˜¯å¯¹æœåŠ¡å™¨å‹åŠ›è¾ƒå¤§ï¼Œæµªè´¹å¸¦å®½æµé‡(é€šå¸¸æƒ…å†µä¸‹éƒ½æ˜¯æ•°æ®æ²¡æœ‰å‘ç”Ÿæ”¹å˜)ã€‚

`å®¢æˆ·ç«¯ä»£ç å¦‚ä¸‹`:


æ‰“å¼€Macä¸‹è‡ªå¸¦çš„è½¯ä»¶ **Automator**

![](https://ww2.sinaimg.cn/large/006tKfTcgy1fckb184f74j319v0q01kx.jpg)

æ–°å»ºæ–‡ç¨¿

![](https://ww1.sinaimg.cn/large/006tKfTcgy1fckb6zzo28j30mo0fvgn7.jpg)

åˆ›å»ºä¸€ä¸ªæœåŠ¡

![](https://ww1.sinaimg.cn/large/006tKfTcgy1fckb93qmy5j30g00fh0vq.jpg)

![](https://ww2.sinaimg.cn/large/006tKfTcgy1fckbfe8o0zj30t10lb0wv.jpg)

![](https://ww1.sinaimg.cn/large/006tKfTcgy1fckbff4e7pj30t10lbwis.jpg)

ä¿®æ”¹æ¡†å†…çš„è„šæœ¬

```
on run {input, parameters}
    tell application "Terminal"
        reopen
        activate
    end tell
end run

```

è¿è¡Œï¼š`command + R`ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œåˆ™ä¼šæ‰“å¼€ç»ˆç«¯

![](https://ww2.sinaimg.cn/large/006tKfTcgy1fckaqdd2m1j30t10lb42a.jpg)

![](https://ww3.sinaimg.cn/large/006tKfTcgy1fckaq4nn9hj30iy0daaan.jpg)

ä¿å­˜ï¼š`Command + S`ï¼Œå°†å…¶å‘½åä¸º`æ‰“å¼€ç»ˆç«¯`æˆ–ä½ æƒ³è¦çš„åå­—

è®¾ç½®å¿«æ·é”®

åœ¨ **ç³»ç»Ÿåå¥½è®¾ç½®** -> **é”®ç›˜è®¾ç½®** -> **å¿«æ·é”®** -> **æœåŠ¡**

é€‰æ‹©æˆ‘ä»¬åˆ›å»ºå¥½çš„ '**æ‰“å¼€ç»ˆç«¯**'ï¼Œè®¾ç½®ä½ æƒ³è¦çš„å¿«æ·é”®ï¼Œæ¯”æˆ‘æˆ‘è®¾ç½®äº†`âŒ˜+ç©ºæ ¼`

![](https://ww4.sinaimg.cn/large/006tKfTcgy1fckbvaixhnj30kw0ihq67.jpg)

åˆ°æ­¤ï¼Œè®¾ç½®å®Œæˆã€‚

èªæ˜çš„ä½ ä¹Ÿè®¸ä¼šå‘ç°ï¼Œè¿™ä¸ªæŠ€å·§èƒ½ä¸ºæ‰€æœ‰çš„ç¨‹åºè®¾ç½®å¿«æ·å¯åŠ¨ã€‚

å°†è„šæœ¬ä¸­çš„ `Terminal` æ›¿æ¢æˆ å…¶ä»–ç¨‹åºå°±å¯ä»¥

```
on run {input, parameters}
    tell application "Terminal"
        reopen
        activate
    end tell
end run

```

## é»‘æŠ€èƒ½

æ—¢ç„¶å­¦äº† `Automator` ï¼Œé‚£å°±åœ¨é™„ä¸Šä¸€ä¸ªé»‘æŠ€èƒ½å§ã€‚ä¸ºä½ çš„ä»£ç æ’åºã€‚åœ¨ **Xcode8**ä»¥å‰ï¼Œæœ‰ä¸ªæ’ä»¶èƒ½ä¸ºä»£ç å¿«é€Ÿæ’åºï¼Œä¸è¿‡æ—¶è¿‡å¢ƒè¿~ å¯¹äºæ²¡ç”¨çš„æ’ä»¶è€Œä¸”åˆæœ‰æ‚£æœ‰å¼ºè¿«ç—‡çš„çš„å°ä¼™ä¼´ï¼Œåªèƒ½æ‰‹åŠ¨æ’åºäº†ï¼ˆğŸ˜‚ï¼‰.

é¦–å…ˆè¿˜æ˜¯åˆ›å»ºä¸€ä¸ªæœåŠ¡

åˆ›å»ºä¸€ä¸ª`Shell`è„šæœ¬ï¼Œ

å‹¾é€‰:`ç”¨è¾“å‡ºå†…å®¹æ›¿æ¢æ‰€é€‰æ–‡æœ¬`

è¾“å…¥ï¼š`sort|uniq` 

ä¿å­˜ï¼š å­˜ä¸º`Sort & Uniq`

![](https://ww4.sinaimg.cn/large/006tKfTcgy1fckd40rgwmj30rt0ildiy.jpg)

**é€‰ä¸­ä½ çš„ä»£ä»£ç ** -> **é¼ æ ‡å³é”®** -> **Servies** -> **Sort&Uniq**

![](https://ww2.sinaimg.cn/large/006tKfTcgy1fckd6tx1dzj30h90b7mzm.jpg)

æ’åºåçš„ä»£ç ï¼š

![](https://ww3.sinaimg.cn/large/006tKfTcgy1fckd6lak55j309j05y3yo.jpg)

